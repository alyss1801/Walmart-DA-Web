@startuml Data_Pipeline_with_Quality_Gates
!define WALMART_BLUE #0071CE
!define WALMART_YELLOW #FFC220
!define SUCCESS_GREEN #28A745
!define WARNING_ORANGE #FD7E14
!define DANGER_RED #DC3545

title <b>Walmart Data Pipeline v·ªõi Data Quality Gates</b>\n<i>Raw ‚Üí Silver ‚Üí Golden Architecture</i>

skinparam backgroundColor #FEFEFE
skinparam roundCorner 15
skinparam shadowing false

skinparam activity {
    BackgroundColor #E8F4FD
    BorderColor WALMART_BLUE
    FontSize 12
}

skinparam rectangle {
    BorderColor WALMART_BLUE
    BorderThickness 2
}

|#F5F5F5|Raw Layer|
start
:üì• **Data Sources**
====
‚Ä¢ cleaned_products_API.csv
‚Ä¢ marketing_data.csv
‚Ä¢ Walmart_customer_purchases.csv
‚Ä¢ walmart_products.csv;

|#FFF3CD|Quality Gate 1|
#WARNING_ORANGE:üîç **PRE-SILVER CHECK**
----
‚úì File existence
‚úì Row count > 0
‚úì Critical columns not empty
‚úì Data type validation;

if (Quality OK?) then (‚úÖ Pass)
else (‚ùå Fail)
    #DANGER_RED:‚ö†Ô∏è Log Warning
    or Stop Pipeline;
    note right
        **Mode: WARN**
        Continue with warnings
        ----
        **Mode: FAIL**
        Stop pipeline
    end note
endif

|#D4EDDA|Silver Layer (Clean)|
:üßπ **ETL Processing**
====
**Extract:**
‚Ä¢ Read CSV files
**Transform:**
‚Ä¢ Clean null values
‚Ä¢ Standardize formats
‚Ä¢ Remove duplicates
**Load:**
‚Ä¢ Save to Clean folder
‚Ä¢ Load to staging.db;

|#FFF3CD|Quality Gate 2|
#WARNING_ORANGE:üîç **POST-SILVER CHECK**
----
‚úì Row count preservation
‚úì Unique key validation
‚úì Null ratio < 5%
‚úì Schema compliance;

if (Quality OK?) then (‚úÖ Pass)
else (‚ùå Fail)
    #DANGER_RED:‚ö†Ô∏è Log Warning
    or Stop Pipeline;
endif

|#CCE5FF|Golden Layer|
:‚≠ê **Standardization**
====
‚Ä¢ Normalize column names
‚Ä¢ Parse dates (dayfirst=True)
‚Ä¢ Standardize categories;

:üìê **Build Dimensions**
====
‚Ä¢ DIM_DATE / DIM_DATE_STORE
‚Ä¢ DIM_CUSTOMER
‚Ä¢ DIM_PRODUCT / DIM_ECOMMERCE_PRODUCT
‚Ä¢ DIM_CATEGORY / DIM_ECOMMERCE_CATEGORY
‚Ä¢ DIM_PAYMENT
‚Ä¢ DIM_STORE
‚Ä¢ DIM_TEMPERATURE
‚Ä¢ DIM_ECOMMERCE_BRAND;

:üìä **Build Facts**
====
‚Ä¢ FACT_SALES (~50K rows)
‚Ä¢ FACT_STORE_PERFORMANCE (6,435 rows)
‚Ä¢ FACT_ECOMMERCE_SALES (~30K rows);

|#FFF3CD|Quality Gate 3|
#WARNING_ORANGE:üîç **POST-GOLDEN CHECK**
----
‚úì PK uniqueness
‚úì FK referential integrity
‚úì No orphaned keys
‚úì No sentinel values (date_key = -1)
‚úì Measure ranges valid
‚úì Business rules;

if (Quality OK?) then (‚úÖ Pass)
    |#D4EDDA|Output|
    #SUCCESS_GREEN:üèÅ **Pipeline Complete**
    ====
    ‚úÖ Golden CSVs generated
    ‚úÖ DuckDB warehouse updated
    ‚úÖ Quality report exported;
    stop
else (‚ùå Fail)
    #DANGER_RED:üö® **Quality Gate Failed**
    ====
    ‚ö†Ô∏è Review quality report
    ‚ö†Ô∏è Fix data issues
    ‚ö†Ô∏è Re-run pipeline;
    stop
endif

legend right
    |= Symbol |= Meaning |
    | üîç | Quality Check |
    | ‚úÖ | Check Passed |
    | ‚ùå | Check Failed |
    | ‚ö†Ô∏è | Warning |
    --
    **Quality Gates:**
    Gate 1: Pre-Silver
    Gate 2: Post-Silver  
    Gate 3: Post-Golden
endlegend

footer \n<b>Walmart Data Analytics Pipeline</b>\nWith integrated Data Quality Framework

@enduml
